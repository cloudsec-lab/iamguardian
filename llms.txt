# IAMGuardian

> Automated IAM permission audit and remediation across multi-cloud (AWS, Azure, GCP)

## What this project does

IAMGuardian scans IAM/RBAC policies across AWS, Azure, and GCP to detect:
- Excessive permissions (AdminAccess, Owner roles)
- Dormant accounts (no login > 90 days)
- Missing MFA
- Old access keys (> 90 days)
- Privilege escalation risks

It generates compliance reports mapped to ISO 27001, NIST CSF, and SOC2 frameworks.

## Tech stack

- Python 3.11+ (Pydantic, FastAPI)
- Terraform (multi-cloud IaC)
- AWS SDK (boto3), Azure SDK, GCP SDK
- Gemini API (AI-powered remediation recommendations)
- pytest (testing)

## Core files

- `src/models/finding.py` — Central data model (Finding, ComplianceMapping, Recommendation)
- `src/storage/base_storage.py` — Abstract storage interface
- `src/storage/local_storage.py` — JSON file storage (dev/test)
- `src/scanners/base_scanner.py` — Abstract scanner interface
- `src/scanners/aws_scanner.py` — AWS IAM scanner (currently mock mode)
- `src/analyzer/iam_analyzer.py` — Statistics, compliance scoring, priority filtering
- `src/dashboard/app.py` — FastAPI web dashboard + JSON API
- `src/dashboard/templates/` — Jinja2 HTML templates (6 pages)
- `src/dashboard/static/css/style.css` — Custom CSS (badges, metrics, filters)

## Web pages (browser)

- `GET /` — Dashboard overview (stats + priority findings)
- `GET /findings` — Findings list with cloud/severity filters
- `GET /findings/{id}` — Finding detail with compliance + recommendation
- `GET /stats` — Statistics by severity, cloud, category
- `GET /compliance/{framework}` — Compliance score (iso27001, nist_csf, soc2)

## JSON API (programmatic)

- `GET /api/findings` — List findings (enum-validated filters, 422 on invalid)
- `GET /api/findings/{id}` — Finding detail
- `GET /api/stats` — Statistics
- `GET /api/compliance/{framework}` — Compliance score
- `GET /api/priority` — HIGH/CRITICAL unremediated findings

## Current status

Phase 0-3 complete. 78 tests passing.
- Phase 0: Project structure, data model, local storage
- Phase 2: AWS mock scanner (8 findings, 7 categories), CLI with argparse
- Phase 3: Dashboard web (Jinja2 + Pico.css), API under /api/, 27 dashboard tests
Next: Phase 4 (real AWS scanner with boto3).
